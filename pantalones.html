<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tienda de Ropa - High End Collection</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        .product-image {
            background-color: #f4f4f4;
            background-position: center;
            background-size: cover;
            min-height: 350px;
            position: relative;
        }
        /* Estilo rápido para el contador cuando tiene productos */
        .cart-active {
            font-weight: bold;
            color: #27ae60;
        }
    </style>
</head>
<body>

<header class="main-header">
    <div class="header-container">
        <div class="logo">CLOTHING<span>STUDIO</span></div>
        <nav class="nav-menu">
            <a href="camisetas.html">CAMISETAS</a>
            <a href="pantalones.html">PANTALONES</a>
            <a href="zapatillas.html">ZAPATILLAS</a>
            <a href="#" class="rebajas-link">REBAJAS</a>
        </nav>
        <div class="header-icons">
            <span>Buscar</span>
            <span>Cuenta</span>
            <span id="cart-trigger" style="cursor:pointer">Carrito (0)</span>
        </div>
    </div>
</header>

<div class="container">
    <aside class="sidebar">
        <div class="filter-group">
            <h3>Ordenar por</h3>
            <ul>
                <li class="active">Nuestra selección</li>
                <li>Precio de - a +</li>
                <li>Precio de + a -</li>
            </ul>
        </div>
        <div class="filter-group">
            <h3>Talla</h3>
            <ul class="talla-list">
                <li>38</li><li>40</li><li>42</li><li>44</li>
            </ul>
        </div>
    </aside>

    <main class="main">
        <div class="topbar">
            <h1>Pantalones para hombre</h1>
            <div class="sort">5 RESULTADOS</div>
        </div>

        <div class="products">
            <div class="card-producto">
                <div class="product-image" style="background-image: url('https://images.unsplash.com/photo-1624371414361-e6e0efc583a8?q=80&w=600&auto=format&fit=crop');">
                    <span class="badge-nuevo">Nuevo</span>
                </div>
                <div class="product-info">
                    <h4>Pantalón Chino Slim</h4>
                    <p class="descripcion">Algodón premium.</p>
                    <span class="precio">119.00 €</span>
                    <button class="btn-comprar">Añadir al carrito</button>
                </div>
            </div>
            <div class="card-producto">
                <div class="product-image" style="background-image: url('https://images.unsplash.com/photo-1542272604-787c3835535d?q=80&w=600&auto=format&fit=crop');"></div>
                <div class="product-info">
                    <h4>Vaquero Selvedge</h4>
                    <p class="descripcion">Denim artesanal.</p>
                    <span class="precio">145.00 €</span>
                    <button class="btn-comprar">Añadir al carrito</button>
                </div>
            </div>
            <div class="card-producto">
                <div class="product-image" style="background-image: url('https://images.unsplash.com/photo-1594633312681-425c7b97ccd1?q=80&w=600&auto=format&fit=crop');"></div>
                <div class="product-info">
                    <h4>Pantalón de Lino</h4>
                    <p class="descripcion">Tejido ligero.</p>
                    <span class="precio">95.00 €</span>
                    <button class="btn-comprar">Añadir al carrito</button>
                </div>
            </div>
        </div>
    </main>
</div>

<div id="cart-drawer" style="position: fixed; top: 0; right: -400px; width: 350px; height: 100%; background: white; box-shadow: -10px 0 30px rgba(0,0,0,0.2); z-index: 10001; transition: 0.4s; padding: 30px; display: flex; flex-direction: column; font-family: 'Inter', sans-serif;">
    <div style="display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #000; padding-bottom: 15px;">
        <h2 style="margin: 0; font-size: 1.2rem; letter-spacing: 2px;">MI CARRITO</h2>
        <button id="close-cart" style="background: none; border: none; font-size: 30px; cursor: pointer;">&times;</button>
    </div>
    
    <div id="cart-items-list" style="flex-grow: 1; overflow-y: auto; padding: 20px 0;">
        <p id="cart-empty-msg" style="text-align: center; color: #999; margin-top: 50px;">El carrito está vacío</p>
    </div>

    <div style="border-top: 1px solid #eee; padding-top: 20px;">
        <div style="display: flex; justify-content: space-between; font-weight: 700; font-size: 1.1rem; margin-bottom: 20px;">
            <span>TOTAL</span>
            <span id="cart-total-amount">0.00 €</span>
        </div>
        <button id="checkout-final" style="width: 100%; background: #000; color: #fff; border: none; padding: 18px; font-weight: bold; cursor: pointer; letter-spacing: 1px;">FINALIZAR COMPRA</button>
    </div>
</div>

<div id="cart-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); display: none; z-index: 10000;"></div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const cartDrawer = document.getElementById('cart-drawer');
    const cartOverlay = document.getElementById('cart-overlay');
    const cartTrigger = document.getElementById('cart-trigger');
    const closeCart = document.getElementById('close-cart');
    const itemsList = document.getElementById('cart-items-list');
    const totalDisplay = document.getElementById('cart-total-amount');
    const emptyMsg = document.getElementById('cart-empty-msg');
    const checkoutBtn = document.getElementById('checkout-final');
    
    let carrito = [];

    // Función para abrir/cerrar
    const toggleCart = () => {
        const isOpen = cartDrawer.style.right === '0px';
        cartDrawer.style.right = isOpen ? '-400px' : '0px';
        cartOverlay.style.display = isOpen ? 'none' : 'block';
    };

    cartTrigger.addEventListener('click', toggleCart);
    closeCart.addEventListener('click', toggleCart);
    cartOverlay.addEventListener('click', toggleCart);

    // Lógica de añadir
    const botones = document.querySelectorAll('.btn-comprar');
    botones.forEach(btn => {
        btn.addEventListener('click', () => {
            const card = btn.closest('.card-producto');
            const nombre = card.querySelector('h4').innerText;
            const precio = parseFloat(card.querySelector('.precio').innerText.replace('€', ''));

            carrito.push({ nombre, precio });
            renderCarrito();
            
            // Animación simple del botón
            btn.innerText = "✓ AÑADIDO";
            btn.style.backgroundColor = "#27ae60";
            setTimeout(() => {
                btn.innerText = "Añadir al carrito";
                btn.style.backgroundColor = "";
            }, 700);
        });
    });

    function renderCarrito() {
        // Actualizar contador header
        cartTrigger.innerText = `Carrito (${carrito.length})`;
        if(carrito.length > 0) cartTrigger.classList.add('cart-active');

        // Limpiar lista
        itemsList.innerHTML = '';
        if (carrito.length === 0) {
            itemsList.appendChild(emptyMsg);
            totalDisplay.innerText = "0.00 €";
        } else {
            let subtotal = 0;
            carrito.forEach((item, index) => {
                subtotal += item.precio;
                const div = document.createElement('div');
                div.style = "display:flex; justify-content:space-between; margin-bottom:15px; border-bottom:1px solid #f4f4f4; padding-bottom:10px;";
                div.innerHTML = `
                    <span style="font-weight:500;">${item.nombre}</span>
                    <span>${item.precio.toFixed(2)} €</span>
                `;
                itemsList.appendChild(div);
            });
            totalDisplay.innerText = `${subtotal.toFixed(2)} €`;
        }
    }

    checkoutBtn.addEventListener('click', () => {
        if(carrito.length > 0) {
            // ALERTA PERSONALIZADA FINAL
            const confirmacion = document.createElement('div');
            confirmacion.style = "position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); background:white; padding:40px; z-index:20000; text-align:center; box-shadow:0 0 50px rgba(0,0,0,0.5); width:300px;";
            confirmacion.innerHTML = `
                <h2 style="margin-top:0">¡GRACIAS!</h2>
                <p>Tu compra de ${totalDisplay.innerText} ha sido procesada.</p>
                <button id="ok-btn" style="background:black; color:white; border:none; padding:10px 20px; cursor:pointer; width:100%">CERRAR</button>
            `;
            document.body.appendChild(confirmacion);
            
            document.getElementById('ok-btn').onclick = () => {
                confirmacion.remove();
                carrito = [];
                renderCarrito();
                toggleCart();
            };
        }
    });
});
</script>

</body>
</html>